{% extends "base.html" %}
{% load widget_tweaks %}

{% block titulo %}
    {{ titulo }}
{% endblock titulo %}

{% block contenido %}
<div class="container mt-4">
    <div class="card shadow-sm">
        <div class="card-header bg-warning text-white">
            <h4 class="mb-0">Revisar Reclamación #{{ reclamacion.id }}</h4>
        </div>
        <div class="card-body">
            <p><strong>Paciente:</strong> {{ reclamacion.paciente.nombre_completo }}</p>
            <p><strong>Aseguradora:</strong> {{ reclamacion.plan_seguro.aseguradora.nombre }}</p>
            <p><strong>Monto Solicitado:</strong> <span class="text-danger fw-bold">$ {{ reclamacion.monto_solicitado }}</span></p>
            <hr>

            <form method="post">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="monto_aprobado" class="form-label">Monto Aprobado:</label>
                    <input type="number" step="0.01" class="form-control" id="monto_aprobado" name="monto_aprobado" 
                           value="{{ reclamacion.monto_aprobado|default:reclamacion.monto_solicitado }}" required>
                </div>
                <div class="mb-3">
                    <label for="estado" class="form-label">Cambiar Estado:</label>
                    <select class="form-select" id="estado" name="estado" required>
                        <option value="ENVIADA" {% if reclamacion.estado == 'ENVIADA' %}selected{% endif %}>Enviada</option>
                        <option value="APROBADA" {% if reclamacion.estado == 'APROBADA' %}selected{% endif %}>Aprobada</option>
                        <option value="DENEGADA" {% if reclamacion.estado == 'DENEGADA' %}selected{% endif %}>Denegada</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-warning me-2"><i class="bi bi-check-circle"></i> Guardar Revisión</button>
                <a href="{% url 'detalle_reclamacion' reclamacion.pk %}" class="btn btn-secondary">Cancelar</a>
            </form>
        </div>
    </div>
</div>
{% endblock contenido %}